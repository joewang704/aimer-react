(this["webpackJsonpaimer-react"]=this["webpackJsonpaimer-react"]||[]).push([[0],{15:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var r,a,c,i,s,o,u,l,d,h,j,b,x,p=n(0),O=n.n(p),m=n(8),v=n.n(m),f=(n(15),n(5)),g=n(4),y=n(7),E=n(3),w=n(1),I=E.a.div(r||(r=Object(g.a)(["\n"]))),P={enemies:[{name:"Slime",hp:100,maxHP:100,damage:10,xp:5},{name:"Slime",hp:100,maxHP:100,damage:10,xp:5},{name:"Slime",hp:100,maxHP:100,damage:10,xp:5},{name:"Slime Boss",hp:1e3,maxHP:1e3,damage:20,xp:10}]},k=function(e){var t=e.openGameScreen,n=Object(p.useContext)(W),r=(n.state,n.dispatch);return Object(w.jsx)(I,{children:Object(w.jsx)("button",{onClick:function(){r({type:"startGame",payload:P}),t()},children:"Dungeon 1"})})},S=function(){var e=Object(p.useContext)(W),t=e.state,n=e.dispatch;return Object(w.jsxs)("div",{children:[Object(w.jsx)("br",{}),Object(w.jsxs)("span",{children:["Current Sensitivity: ",t.sensitivity]}),Object(w.jsx)("br",{}),Object(w.jsx)("br",{}),Object(w.jsx)("input",{type:"number",step:"0.01",value:t.sensitivity,onChange:function(e){return n({type:"setSensitivity",payload:{sensitivity:e.target.value}})}})]})},C=n(22),L=E.a.div(a||(a=Object(g.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100px;\n  background-color: white;\n  padding: 24px;\n  h1 {\n    font-size: 16px;\n  }\n"]))),M=E.a.div(c||(c=Object(g.a)(["\n  position: relative;\n  width: calc(100% - 48px);\n  height: 50px;\n  text-align: center;\n  line-height: 50px;\n  border: 1px solid #666;\n"]))),H=E.a.div(i||(i=Object(g.a)(["\n  ","\n  background-color: red;\n  position: absolute;\n  height: 100%;\n  top: 0;\n"])),(function(e){var t=e.percent;return{width:"".concat(Math.floor(100*t),"%")}})),R=E.a.div(s||(s=Object(g.a)(["\n  z-index: 2;\n  position: relative;\n"]))),G=function(){var e=Object(p.useContext)(W).state,t=e.enemies[e.currentEnemyIdx];return Object(w.jsxs)(L,{children:[Object(w.jsxs)("h1",{children:[t.name,", Damage: ",t.damage,", XP Gained on Kill: ",t.xp]}),Object(w.jsxs)(M,{children:[Object(w.jsxs)(R,{children:[t.hp," / ",t.maxHP]}),Object(w.jsx)(H,{percent:t.hp/t.maxHP})]})]})},N=n(2),D={status:"INITIAL",player:{hp:100,maxHP:100,damage:10,level:1,xp:0},sensitivity:1},F=function(e){return e*e*10},T=function(e,t){switch(t.type){case"setSensitivity":return Object(N.a)(Object(N.a)({},e),{},{sensitivity:t.payload.sensitivity});case"startGame":return Object(N.a)(Object(N.a)({},e),{},{status:"RUNNING",enemies:t.payload.enemies,currentEnemyIdx:0});case"nextEnemy":return Object(N.a)(Object(N.a)({},e),{},{currentEnemyIdx:e.currentEnemyIdx+1});case"damageEnemy":var n=e.enemies,r=e.currentEnemyIdx,a=n[r],c=n.slice(),i=Math.max(a.hp-10,0);c[r]=Object(N.a)(Object(N.a)({},a),{},{hp:i});var s=i?r:r+1,o=e.player;if(!i){var u=e.player.xp+a.xp,l=e.player.level,d=F(l);u>=d&&(u=d-u,l++),o=Object(N.a)(Object(N.a)({},e.player),{},{xp:u,level:l})}return s>=n.length?{status:"COMPLETED"}:Object(N.a)(Object(N.a)({},e),{},{player:o,enemies:c,currentEnemyIdx:s});case"takeDamage":var h=e.enemies[e.currentEnemyIdx],j=Math.max(e.player.hp-h.damage,0);return j?Object(N.a)(Object(N.a)({},e),{},{player:Object(N.a)(Object(N.a)({},e.player),{},{hp:j})}):{status:"GAME_OVER"};case"endGame":return Object(N.a)(Object(N.a)({},e),{},{status:"INITIAL"});default:return e}},z=E.a.div(o||(o=Object(g.a)(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 150px;\n  background-color: white;\n  padding: 24px;\n  h1 {\n    font-size: 16px;\n  }\n"]))),A=E.a.div(u||(u=Object(g.a)(["\n  position: relative;\n  width: calc(100% - 48px);\n  height: 50px;\n  text-align: center;\n  line-height: 50px;\n  border: 1px solid #666;\n"]))),B=E.a.div(l||(l=Object(g.a)(["\n  ","\n  background-color: red;\n  position: absolute;\n  height: 100%;\n  top: 0;\n"])),(function(e){var t=e.percent;return{width:"".concat(Math.floor(100*t),"%")}})),Y=E.a.div(d||(d=Object(g.a)(["\n  z-index: 2;\n  position: relative;\n"]))),J=E.a.div(h||(h=Object(g.a)(["\n  position: relative;\n  width: calc(100% - 48px);\n  height: 30px;\n  text-align: center;\n  line-height: 30px;\n  border: 1px solid #666;\n"]))),U=E.a.div(j||(j=Object(g.a)(["\n  ","\n  background-color: yellow;\n  position: absolute;\n  height: 100%;\n  top: 0;\n"])),(function(e){var t=e.percent;return{width:"".concat(Math.floor(100*t),"%")}})),V=(E.a.div(b||(b=Object(g.a)(["\n  z-index: 2;\n  position: relative;\n"]))),function(){var e=Object(p.useContext)(W).state.player,t=F(e.level);return Object(w.jsxs)(z,{children:[Object(w.jsxs)("h1",{children:["Player, Level: ",e.level,", Damage: ",e.damage]}),Object(w.jsxs)(A,{children:[Object(w.jsxs)(Y,{children:[e.hp," / ",e.maxHP]}),Object(w.jsx)(B,{percent:e.hp/e.maxHP})]}),Object(w.jsxs)(J,{children:[Object(w.jsxs)(Y,{children:[e.xp," / ",t]}),Object(w.jsx)(U,{percent:e.xp/t})]})]})}),X=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)},_=function(e,t){var n=Object(p.useRef)({values:t,handler:function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e.apply(void 0,r.concat([n.current.values]))}});return n.current.values=t,n.current.handler},q=function(e){var t=e.screenHandle,n=Object(p.useContext)(W),r=n.state,a=n.dispatch,c=Object(p.useRef)(null),i=Object(p.useState)(),s=Object(f.a)(i,2),o=s[0],u=s[1],l=Object(p.useState)(),d=Object(f.a)(l,2),h=d[0],j=d[1],b=Object(p.useRef)({x:100,y:100}),x=Object(p.useRef)([]),O=Object(p.useRef)(r);Object(p.useEffect)((function(){O.current=r}),[r]),Object(p.useEffect)((function(){var e=c.current;u(e);var n=c.current.getContext("2d");j(n);var r=window,a=r.innerWidth,i=r.innerHeight;return c.current.width=a,c.current.height=i,e.requestPointerLock(),document.addEventListener("pointerlockchange",(function(){return y(e)}),!1),document.addEventListener("click",m),function(){document.exitPointerLock(),t.exit()}}),[]),Object(p.useEffect)((function(){var e;return o&&h&&(e=C.a(g)),function(){return e&&e.stop()}}),[o,h]);var m=function(){var e=b.current.x,t=b.current.y,n=x.current,c=n.filter((function(n){var r=n.x,a=n.y,c=n.width,i=n.height;return!(e+5>=r&&e-5<=r+c&&t+5>=a&&t-5<=a+i)})),i=O.current;i.enemies[i.currentEnemyIdx];c.length===n.length?a({type:"takeDamage"}):(x.current=c,a({type:"damageEnemy",payload:{damage:r.player.damage}}))},v=function(e,t){var n;t.fillStyle="grey",t.fillRect(0,0,e.width,e.height),function(e){x.current.forEach((function(t){var n=t.x,r=t.y,a=t.width,c=t.height;e.fillStyle="yellow",e.fillRect(n,r,a,c)}))}(t),t.fillStyle="#f00",t.beginPath(),t.arc(b.current.x,b.current.y,5,0,(n=360,Math.PI/180*n),!0),t.fill(),t.closePath()},g=_((function(e,t){var n=Object(f.a)(t,2),r=n[0],a=n[1];r&&a&&(!function(e){if(!x.current.length&&e){var t=e.width,n=e.height,r=X(t/2-t/4,t-50-t/2),a=X(n/2-n/4,n-50-n/2);x.current=[{x:r,y:a,width:50,height:50}]}}(r),v(r,a))}),[o,h]),y=function(e){document.pointerLockElement!==e&&document.mozPointerLockElement!==e||e.addEventListener("mousemove",(function(e){return E(e)}),!1)},E=_((function(e,t){var n=Object(f.a)(t,2),a=n[0],c=n[1];if(c){var i=a.current,s=i.x,o=i.y;if(s>c.width)a.current={x:c.width-1,y:o};else if(o>c.height)a.current={x:s,y:c.height-1};else if(s<0)a.current={x:1,y:o};else if(o<0)a.current={x:s,y:1};else{var u=e.movementX*(r.sensitivity||1),l=e.movementY*(r.sensitivity||1);a.current={x:s+u,y:o+l}}}}),[b,o]);return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("canvas",{ref:c}),Object(w.jsx)(G,{}),Object(w.jsx)(V,{})]})},K=E.a.div(x||(x=Object(g.a)(["\n"]))),W=O.a.createContext(),Q=function(){var e=Object(p.useReducer)(T,D),t=Object(f.a)(e,2),n=t[0],r=t[1],a=Object(y.b)();return Object(w.jsx)(W.Provider,{value:{state:n,dispatch:r},children:Object(w.jsxs)(K,{children:["INITIAL"===n.status&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(k,{openGameScreen:a.enter}),Object(w.jsx)(S,{})]}),Object(w.jsx)(y.a,{handle:a,children:"RUNNING"===n.status&&a.active&&Object(w.jsx)(q,{screenHandle:a})}),"COMPLETED"===n.status&&Object(w.jsx)(w.Fragment,{children:"You're a beast lol"}),"GAME_OVER"===n.status&&Object(w.jsx)(w.Fragment,{children:"You suck lol"})]})})},Z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,23)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))};v.a.render(Object(w.jsx)(O.a.StrictMode,{children:Object(w.jsx)(Q,{})}),document.getElementById("root")),Z()}},[[20,1,2]]]);
//# sourceMappingURL=main.29931ae8.chunk.js.map