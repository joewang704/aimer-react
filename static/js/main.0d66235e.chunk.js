(this["webpackJsonpaimer-react"]=this["webpackJsonpaimer-react"]||[]).push([[0],{15:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var r,a,c,i,s,o,u,l,d,h,j,b,x,p=n(0),O=n.n(p),v=n(8),m=n.n(v),f=(n(15),n(5)),g=n(4),y=n(7),w=n(3),E=n(1),I=w.a.div(r||(r=Object(g.a)(["\n"]))),P={enemies:[{name:"Slime",hp:100,maxHP:100,damage:10,xp:5},{name:"Slime",hp:100,maxHP:100,damage:10,xp:5},{name:"Slime",hp:100,maxHP:100,damage:10,xp:5},{name:"Slime Boss",hp:1e3,maxHP:1e3,damage:100,xp:10}]},k=function(e){var t=e.openGameScreen,n=Object(p.useContext)(V),r=(n.state,n.dispatch);return Object(E.jsx)(I,{children:Object(E.jsx)("button",{onClick:function(){r({type:"startGame",payload:P}),t()},children:"Dungeon 1"})})},S=function(){var e=Object(p.useContext)(V),t=e.state,n=e.dispatch;return Object(E.jsxs)("div",{children:[Object(E.jsx)("br",{}),Object(E.jsxs)("span",{children:["Current Sensitivity: ",t.sensitivity]}),Object(E.jsx)("br",{}),Object(E.jsx)("br",{}),Object(E.jsx)("input",{type:"number",step:"0.01",value:t.sensitivity,onChange:function(e){return n({type:"setSensitivity",payload:{sensitivity:e.target.value}})}})]})},C=n(22),L=w.a.div(a||(a=Object(g.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100px;\n  background-color: white;\n  padding: 24px;\n  h1 {\n    font-size: 16px;\n  }\n"]))),H=w.a.div(c||(c=Object(g.a)(["\n  position: relative;\n  width: calc(100% - 48px);\n  height: 50px;\n  text-align: center;\n  line-height: 50px;\n  border: 1px solid #666;\n"]))),M=w.a.div(i||(i=Object(g.a)(["\n  ","\n  background-color: red;\n  position: absolute;\n  height: 100%;\n  top: 0;\n"])),(function(e){var t=e.percent;return{width:"".concat(Math.floor(100*t),"%")}})),R=w.a.div(s||(s=Object(g.a)(["\n  z-index: 2;\n  position: relative;\n"]))),N=function(){var e=Object(p.useContext)(V).state,t=e.enemies[e.currentEnemyIdx];return Object(E.jsxs)(L,{children:[Object(E.jsxs)("h1",{children:[t.name,", Damage: ",t.damage,", XP Gained on Kill: ",t.xp]}),Object(E.jsxs)(H,{children:[Object(E.jsxs)(R,{children:[t.hp," / ",t.maxHP]}),Object(E.jsx)(M,{percent:t.hp/t.maxHP})]})]})},G=n(2),D={status:"INITIAL",player:{hp:100,maxHP:100,damage:10,level:1,xp:0},sensitivity:1},z=function(e){return e*e*10},F=function(e,t){switch(t.type){case"setSensitivity":return Object(G.a)(Object(G.a)({},e),{},{sensitivity:t.payload.sensitivity});case"startGame":return Object(G.a)(Object(G.a)({},e),{},{status:"RUNNING",enemies:t.payload.enemies,currentEnemyIdx:0});case"nextEnemy":return Object(G.a)(Object(G.a)({},e),{},{currentEnemyIdx:e.currentEnemyIdx+1});case"damageEnemy":var n=e.enemies,r=e.currentEnemyIdx,a=n[r],c=n.slice(),i=Math.max(a.hp-10,0);c[r]=Object(G.a)(Object(G.a)({},a),{},{hp:i});var s=i?r:r+1,o=e.player;if(!i){var u=e.player.xp+a.xp,l=e.player.level,d=z(l);u>=d&&(u=d-u,l++),o=Object(G.a)(Object(G.a)({},e.player),{},{xp:u,level:l})}return s>=n.length?{status:"COMPLETED"}:Object(G.a)(Object(G.a)({},e),{},{player:o,enemies:c,currentEnemyIdx:s});case"takeDamage":var h=e.enemies[e.currentEnemyIdx];return Object(G.a)(Object(G.a)({},e),{},{player:Object(G.a)(Object(G.a)({},e.player),{},{hp:e.player.hp-h.damage})});case"endGame":return Object(G.a)(Object(G.a)({},e),{},{status:"INITIAL"});default:return e}},T=w.a.div(o||(o=Object(g.a)(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 150px;\n  background-color: white;\n  padding: 24px;\n  h1 {\n    font-size: 16px;\n  }\n"]))),A=w.a.div(u||(u=Object(g.a)(["\n  position: relative;\n  width: calc(100% - 48px);\n  height: 50px;\n  text-align: center;\n  line-height: 50px;\n  border: 1px solid #666;\n"]))),B=w.a.div(l||(l=Object(g.a)(["\n  ","\n  background-color: red;\n  position: absolute;\n  height: 100%;\n  top: 0;\n"])),(function(e){var t=e.percent;return{width:"".concat(Math.floor(100*t),"%")}})),J=w.a.div(d||(d=Object(g.a)(["\n  z-index: 2;\n  position: relative;\n"]))),U=w.a.div(h||(h=Object(g.a)(["\n  position: relative;\n  width: calc(100% - 48px);\n  height: 30px;\n  text-align: center;\n  line-height: 30px;\n  border: 1px solid #666;\n"]))),X=w.a.div(j||(j=Object(g.a)(["\n  ","\n  background-color: yellow;\n  position: absolute;\n  height: 100%;\n  top: 0;\n"])),(function(e){var t=e.percent;return{width:"".concat(Math.floor(100*t),"%")}})),q=(w.a.div(b||(b=Object(g.a)(["\n  z-index: 2;\n  position: relative;\n"]))),function(){var e=Object(p.useContext)(V).state.player,t=z(e.level);return Object(E.jsxs)(T,{children:[Object(E.jsxs)("h1",{children:["Player, Level: ",e.level,", Damage: ",e.damage]}),Object(E.jsxs)(A,{children:[Object(E.jsxs)(J,{children:[e.hp," / ",e.maxHP]}),Object(E.jsx)(B,{percent:e.hp/e.maxHP})]}),Object(E.jsxs)(U,{children:[Object(E.jsxs)(J,{children:[e.xp," / ",t]}),Object(E.jsx)(X,{percent:e.xp/t})]})]})}),K=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)},W=function(e,t){var n=Object(p.useRef)({values:t,handler:function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e.apply(void 0,r.concat([n.current.values]))}});return n.current.values=t,n.current.handler},Y=function(e){var t=e.screenHandle,n=Object(p.useContext)(V),r=n.state,a=n.dispatch,c=Object(p.useRef)(null),i=Object(p.useState)(),s=Object(f.a)(i,2),o=s[0],u=s[1],l=Object(p.useState)(),d=Object(f.a)(l,2),h=d[0],j=d[1],b=Object(p.useRef)({x:100,y:100}),x=Object(p.useRef)([]),O=Object(p.useRef)(r);Object(p.useEffect)((function(){O.current=r}),[r]),Object(p.useEffect)((function(){var e=c.current;u(e);var n=c.current.getContext("2d");j(n);var r=window,a=r.innerWidth,i=r.innerHeight;return c.current.width=a,c.current.height=i,e.requestPointerLock(),document.addEventListener("pointerlockchange",(function(){return y(e)}),!1),document.addEventListener("click",v),function(){document.exitPointerLock(),t.exit()}}),[]),Object(p.useEffect)((function(){var e;return o&&h&&(e=C.a(g)),function(){return e&&e.stop()}}),[o,h]);var v=function(){var e=b.current.x,t=b.current.y,n=x.current,c=n.filter((function(n){var r=n.x,a=n.y,c=n.width,i=n.height;return!(e+5>=r&&e-5<=r+c&&t+5>=a&&t-5<=a+i)})),i=O.current;i.enemies[i.currentEnemyIdx];c.length===n.length?a({type:"takeDamage"}):(x.current=c,a({type:"damageEnemy",payload:{damage:r.player.damage}}))},m=function(e,t){var n;t.fillStyle="grey",t.fillRect(0,0,e.width,e.height),function(e){x.current.forEach((function(t){var n=t.x,r=t.y,a=t.width,c=t.height;e.fillStyle="yellow",e.fillRect(n,r,a,c)}))}(t),t.fillStyle="#f00",t.beginPath(),t.arc(b.current.x,b.current.y,5,0,(n=360,Math.PI/180*n),!0),t.fill(),t.closePath()},g=W((function(e,t){var n=Object(f.a)(t,2),r=n[0],a=n[1];r&&a&&(!function(e){if(!x.current.length&&e){var t=e.width,n=e.height,r=K(t/2-t/4,t-50-t/2),a=K(n/2-n/4,n-50-n/2);x.current=[{x:r,y:a,width:50,height:50}]}}(r),m(r,a))}),[o,h]),y=function(e){document.pointerLockElement!==e&&document.mozPointerLockElement!==e||e.addEventListener("mousemove",(function(e){return w(e)}),!1)},w=W((function(e,t){var n=Object(f.a)(t,2),a=n[0],c=n[1];if(c){var i=a.current,s=i.x,o=i.y;if(s>c.width)a.current={x:c.width-1,y:o};else if(o>c.height)a.current={x:s,y:c.height-1};else if(s<0)a.current={x:1,y:o};else if(o<0)a.current={x:s,y:1};else{var u=e.movementX*(r.sensitivity||1),l=e.movementY*(r.sensitivity||1);a.current={x:s+u,y:o+l}}}}),[b,o]);return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("canvas",{ref:c}),Object(E.jsx)(N,{}),Object(E.jsx)(q,{})]})},Q=w.a.div(x||(x=Object(g.a)(["\n"]))),V=O.a.createContext(),Z=function(){var e=Object(p.useReducer)(F,D),t=Object(f.a)(e,2),n=t[0],r=t[1],a=Object(y.b)();return Object(E.jsx)(V.Provider,{value:{state:n,dispatch:r},children:Object(E.jsxs)(Q,{children:["INITIAL"===n.status&&Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(k,{openGameScreen:a.enter}),Object(E.jsx)(S,{})]}),Object(E.jsx)(y.a,{handle:a,children:"RUNNING"===n.status&&a.active&&Object(E.jsx)(Y,{screenHandle:a})})]})})},$=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,23)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))};m.a.render(Object(E.jsx)(O.a.StrictMode,{children:Object(E.jsx)(Z,{})}),document.getElementById("root")),$()}},[[20,1,2]]]);
//# sourceMappingURL=main.0d66235e.chunk.js.map