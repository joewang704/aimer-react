(this["webpackJsonpaimer-react"]=this["webpackJsonpaimer-react"]||[]).push([[0],{15:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var r,a,i,c,s,l,o,u,d,h,j,p,x,b,m=n(1),v=n.n(m),O=n(8),f=n.n(O),g=(n(15),n(5)),y=n(4),E=n(7),w=n(2),I=n(0),S=w.a.div(r||(r=Object(y.a)(["\n  display: flex;\n"]))),P=w.a.div(a||(a=Object(y.a)(["\n  background-color: #eee;\n  margin: 24px;\n  padding: 24px;\n  padding-top: 8px;\n  border-radius: 4px;\n"]))),k={name:"Slime",hp:100,maxHP:100,damage:10,xp:5,lvl:1},C={name:"Boogie",hp:400,maxHP:400,damage:40,xp:50,lvl:5},L=[{name:"Slime Farm",enemies:[k,k,k,k,k,k,k,k,k,k],timer:9999,lvl:1},{name:"Slime Dungeon",enemies:[k,k,k,{name:"Slime Boss",hp:500,maxHP:500,damage:20,xp:10,lvl:1}],timer:60,lvl:1},{name:"Boogie Farm",enemies:[C,C,C,C,C,C,C,C,C,C],timer:9999,lvl:5},{name:"Boogie Dungeon",enemies:[C,C,C,{name:"Oogie Boss",hp:1500,maxHP:1500,damage:200,xp:50,lvl:5}],timer:60,lvl:5}],M=function(e){var t=e.openGameScreen,n=Object(m.useContext)(ne).dispatch;return Object(I.jsx)(S,{children:L.map((function(e){return Object(I.jsxs)(P,{children:[Object(I.jsx)("h3",{children:e.name}),Object(I.jsxs)("div",{children:["Level: ",e.lvl]}),Object(I.jsx)("div",{children:"Items: TBD"}),Object(I.jsx)("button",{onClick:function(){n({type:"startGame",payload:e}),t()},children:"Start"})]})}))})},H=function(){var e=Object(m.useContext)(ne),t=e.state,n=e.dispatch;return Object(I.jsxs)("div",{children:[Object(I.jsx)("br",{}),Object(I.jsxs)("span",{children:["Current Sensitivity: ",t.sensitivity]}),Object(I.jsx)("br",{}),Object(I.jsx)("br",{}),Object(I.jsx)("input",{type:"number",step:"0.01",value:t.sensitivity,onChange:function(e){return n({type:"setSensitivity",payload:{sensitivity:e.target.value}})}})]})},N=n(22),R=w.a.div(i||(i=Object(y.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100px;\n  background-color: white;\n  padding: 24px;\n  h1 {\n    font-size: 16px;\n  }\n"]))),G=w.a.div(c||(c=Object(y.a)(["\n  position: relative;\n  width: calc(100% - 48px);\n  height: 50px;\n  text-align: center;\n  line-height: 50px;\n  border: 1px solid #666;\n"]))),F=w.a.div(s||(s=Object(y.a)(["\n  ","\n  background-color: red;\n  position: absolute;\n  height: 100%;\n  top: 0;\n"])),(function(e){var t=e.percent;return{width:"".concat(Math.floor(100*t),"%")}})),D=w.a.div(l||(l=Object(y.a)(["\n  z-index: 2;\n  position: relative;\n"]))),B=function(){var e=Object(m.useContext)(ne).state,t=e.enemies[e.currentEnemyIdx];return Object(I.jsxs)(R,{children:[Object(I.jsxs)("h1",{children:[t.name,", Damage: ",t.damage,", XP Gained on Kill: ",t.xp]}),Object(I.jsxs)(G,{children:[Object(I.jsxs)(D,{children:[t.hp," / ",t.maxHP]}),Object(I.jsx)(F,{percent:t.hp/t.maxHP})]})]})},T=n(3),z={hp:100,maxHP:100,level:1,xp:0},A={status:"INITIAL",player:function(){var e=localStorage.getItem("player");if(e){var t=JSON.parse(e);return t.hp=t.maxHP,t}return z}(),sensitivity:localStorage.getItem("sensitivity")||.4},J=function(e){return e*e*10},U=function(e){return e*e+10},Y=function(e,t){switch(t.type){case"setSensitivity":return Object(T.a)(Object(T.a)({},e),{},{sensitivity:t.payload.sensitivity});case"startGame":return Object(T.a)(Object(T.a)({},e),{},{status:"RUNNING",enemies:t.payload.enemies,timer:t.payload.timer,currentEnemyIdx:0});case"nextEnemy":return Object(T.a)(Object(T.a)({},e),{},{currentEnemyIdx:e.currentEnemyIdx+1});case"damageEnemy":var n=e.enemies,r=e.currentEnemyIdx,a=n[r],i=n.slice(),c=Math.max(a.hp-t.payload.damage,0);i[r]=Object(T.a)(Object(T.a)({},a),{},{hp:c});var s=c?r:r+1,l=e.player;if(!c){var o=e.player.xp+a.xp,u=e.player.level,d=J(u);o>=d&&(o=d-o,u++),l=Object(T.a)(Object(T.a)({},e.player),{},{xp:o,level:u})}return s>=n.length?{status:"COMPLETED"}:Object(T.a)(Object(T.a)({},e),{},{player:l,enemies:i,currentEnemyIdx:s});case"takeDamage":var h=e.enemies[e.currentEnemyIdx],j=Math.max(e.player.hp-h.damage,0);return j?Object(T.a)(Object(T.a)({},e),{},{player:Object(T.a)(Object(T.a)({},e.player),{},{hp:j})}):{status:"GAME_OVER"};case"endGame":return Object(T.a)(Object(T.a)({},e),{},{status:"INITIAL"});default:return e}},V=w.a.div(o||(o=Object(y.a)(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 150px;\n  background-color: white;\n  padding: 24px;\n  h1 {\n    font-size: 16px;\n  }\n"]))),X=w.a.div(u||(u=Object(y.a)(["\n  position: relative;\n  width: calc(100% - 48px);\n  height: 50px;\n  text-align: center;\n  line-height: 50px;\n  border: 1px solid #666;\n"]))),_=w.a.div(d||(d=Object(y.a)(["\n  ","\n  background-color: red;\n  position: absolute;\n  height: 100%;\n  top: 0;\n"])),(function(e){var t=e.percent;return{width:"".concat(Math.floor(100*t),"%")}})),q=w.a.div(h||(h=Object(y.a)(["\n  z-index: 2;\n  position: relative;\n"]))),K=w.a.div(j||(j=Object(y.a)(["\n  position: relative;\n  width: calc(100% - 48px);\n  height: 30px;\n  text-align: center;\n  line-height: 30px;\n  border: 1px solid #666;\n"]))),W=w.a.div(p||(p=Object(y.a)(["\n  ","\n  background-color: yellow;\n  position: absolute;\n  height: 100%;\n  top: 0;\n"])),(function(e){var t=e.percent;return{width:"".concat(Math.floor(100*t),"%")}})),Q=(w.a.div(x||(x=Object(y.a)(["\n  z-index: 2;\n  position: relative;\n"]))),function(){var e=Object(m.useContext)(ne).state.player,t=J(e.level),n=U(e.level);return Object(I.jsxs)(V,{children:[Object(I.jsxs)("h1",{children:["Player, Level: ",e.level,", Damage: ",n]}),Object(I.jsxs)(X,{children:[Object(I.jsxs)(q,{children:[e.hp," / ",e.maxHP]}),Object(I.jsx)(_,{percent:e.hp/e.maxHP})]}),Object(I.jsxs)(K,{children:[Object(I.jsxs)(q,{children:[e.xp," / ",t]}),Object(I.jsx)(W,{percent:e.xp/t})]})]})}),Z=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)},$=function(e,t){var n=Object(m.useRef)({values:t,handler:function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e.apply(void 0,r.concat([n.current.values]))}});return n.current.values=t,n.current.handler},ee=function(e){var t=e.screenHandle,n=Object(m.useContext)(ne),r=n.state,a=n.dispatch,i=Object(m.useRef)(null),c=Object(m.useState)(),s=Object(g.a)(c,2),l=s[0],o=s[1],u=Object(m.useState)(),d=Object(g.a)(u,2),h=d[0],j=d[1],p=Object(m.useRef)({x:100,y:100}),x=Object(m.useRef)([]),b=Object(m.useRef)(r);Object(m.useEffect)((function(){b.current=r}),[r]),Object(m.useEffect)((function(){var e=i.current;o(e);var n=i.current.getContext("2d");j(n);var r=window,a=r.innerWidth,c=r.innerHeight;return i.current.width=a,i.current.height=c,e.requestPointerLock(),document.addEventListener("pointerlockchange",(function(){return y(e)}),!1),document.addEventListener("click",v),function(){document.exitPointerLock(),t.exit()}}),[]),Object(m.useEffect)((function(){var e;return l&&h&&(e=N.a(f)),function(){return e&&e.stop()}}),[l,h]);var v=function(){var e=p.current.x,t=p.current.y,n=x.current,i=n.filter((function(n){var r=n.x,a=n.y,i=n.width,c=n.height;return!(e+5>=r&&e-5<=r+i&&t+5>=a&&t-5<=a+c)})),c=b.current;c.enemies[c.currentEnemyIdx];i.length===n.length?a({type:"takeDamage"}):(x.current=i,a({type:"damageEnemy",payload:{damage:U(r.player.level)}}))},O=function(e,t){var n;t.fillStyle="grey",t.fillRect(0,0,e.width,e.height),function(e){x.current.forEach((function(t){var n=t.x,r=t.y,a=t.width,i=t.height;e.fillStyle="yellow",e.fillRect(n,r,a,i)}))}(t),t.fillStyle="#f00",t.beginPath(),t.arc(p.current.x,p.current.y,5,0,(n=360,Math.PI/180*n),!0),t.fill(),t.closePath()},f=$((function(e,t){var n=Object(g.a)(t,2),i=n[0],c=n[1];if(i&&c){!function(e){if(!x.current.length&&e){var t=e.width,n=e.height,r=Z(t/2-t/4,t-50-t/2),a=Z(n/2-n/4,n-50-n/2);x.current=[{x:r,y:a,width:50,height:50}]}}(i),O(i,c),c.fillStyle="white",c.font="30px Helvetica";var s=(r.timer-e/1e3).toFixed(2);if(s<=0)return a({type:"endGame"});c.fillText(s,i.width/2-30,180)}}),[l,h]),y=function(e){document.pointerLockElement!==e&&document.mozPointerLockElement!==e||e.addEventListener("mousemove",(function(e){return E(e)}),!1)},E=$((function(e,t){var n=Object(g.a)(t,2),a=n[0],i=n[1];if(i){var c=a.current,s=c.x,l=c.y;if(s>i.width)a.current={x:i.width-1,y:l};else if(l>i.height)a.current={x:s,y:i.height-1};else if(s<0)a.current={x:1,y:l};else if(l<0)a.current={x:s,y:1};else{var o=e.movementX*(r.sensitivity||1),u=e.movementY*(r.sensitivity||1);a.current={x:s+o,y:l+u}}}}),[p,l]);return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("canvas",{ref:i}),Object(I.jsx)(B,{}),Object(I.jsx)(Q,{})]})},te=w.a.div(b||(b=Object(y.a)(["\n"]))),ne=v.a.createContext(),re=function(){var e=Object(m.useReducer)(Y,A),t=Object(g.a)(e,2),n=t[0],r=t[1],a=Object(E.b)();return Object(m.useEffect)((function(){var e=n.sensitivity,t=n.player;e&&function(e){localStorage.setItem("sensitivity",e)}(e),t&&function(e){localStorage.setItem("player",e)}(JSON.stringify(t))}),[n.sensitivity,n.player]),Object(I.jsx)(ne.Provider,{value:{state:n,dispatch:r},children:Object(I.jsxs)(te,{children:["RUNNING"!==n.status&&Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(M,{openGameScreen:a.enter}),Object(I.jsx)(H,{})]}),Object(I.jsx)(E.a,{handle:a,children:"RUNNING"===n.status&&a.active&&Object(I.jsx)(ee,{screenHandle:a})}),"COMPLETED"===n.status&&Object(I.jsx)(I.Fragment,{children:"You're a beast lol"}),"GAME_OVER"===n.status&&Object(I.jsx)(I.Fragment,{children:"You suck lol"})]})})},ae=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,23)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),i(e),c(e)}))};f.a.render(Object(I.jsx)(v.a.StrictMode,{children:Object(I.jsx)(re,{})}),document.getElementById("root")),ae()}},[[20,1,2]]]);
//# sourceMappingURL=main.2949cca3.chunk.js.map